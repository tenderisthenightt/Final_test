{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2328,"status":"ok","timestamp":1673404846734,"user":{"displayName":"tututu","userId":"15506491728105383454"},"user_tz":-540},"id":"IJjfE8nyJxrM","outputId":"6ad62cb8-a122-433c-e3bf-22ca7eab0c68"},"outputs":[{"output_type":"stream","name":"stdout","text":["Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"],"id":"IJjfE8nyJxrM"},{"cell_type":"markdown","metadata":{"id":"f77de40d"},"source":["# Download yoloV5"],"id":"f77de40d"},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":36},"executionInfo":{"elapsed":359,"status":"ok","timestamp":1673402954421,"user":{"displayName":"tututu","userId":"15506491728105383454"},"user_tz":-540},"id":"ugGKjVwRIOun","outputId":"edb9940a-d514-44c6-eb58-b831bb09f0b7"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["'/content'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":4}],"source":["%pwd"],"id":"ugGKjVwRIOun"},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":7,"status":"ok","timestamp":1673402954809,"user":{"displayName":"tututu","userId":"15506491728105383454"},"user_tz":-540},"id":"PkBNnifTMdVD","outputId":"08b3578b-6946-4b1c-a099-686df263f072"},"outputs":[{"output_type":"stream","name":"stdout","text":["/content/drive/MyDrive/hot-air-balloon-1\n"]}],"source":["%cd /content/drive/MyDrive/hot-air-balloon-1"],"id":"PkBNnifTMdVD"},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":6,"status":"ok","timestamp":1673402955117,"user":{"displayName":"tututu","userId":"15506491728105383454"},"user_tz":-540},"id":"0e49f870","outputId":"f45da23a-35e6-442a-ffa0-41a9629fff40"},"outputs":[{"output_type":"stream","name":"stdout","text":["data.yaml\t   README.dataset.txt\ttest   valid\n","hot-air-balloon-1  README.roboflow.txt\ttrain  yolov5\n"]}],"source":["!ls "],"id":"0e49f870"},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"executionInfo":{"elapsed":184640,"status":"ok","timestamp":1673403143293,"user":{"displayName":"tututu","userId":"15506491728105383454"},"user_tz":-540},"id":"t7lzUqchIYVW","outputId":"34a4827b-fe2d-49de-9243-91c38547f0a4"},"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting roboflow\n","  Downloading roboflow-0.2.24-py3-none-any.whl (46 kB)\n","\u001b[?25l     \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m0.0/46.4 KB\u001b[0m \u001b[31m?\u001b[0m eta \u001b[36m-:--:--\u001b[0m\r\u001b[2K     \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m46.4/46.4 KB\u001b[0m \u001b[31m5.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: numpy>=1.18.5 in /usr/local/lib/python3.8/dist-packages (from roboflow) (1.21.6)\n","Requirement already satisfied: chardet==4.0.0 in /usr/local/lib/python3.8/dist-packages (from roboflow) (4.0.0)\n","Requirement already satisfied: opencv-python-headless>=4.5.1.48 in /usr/local/lib/python3.8/dist-packages (from roboflow) (4.7.0.68)\n","Requirement already satisfied: idna==2.10 in /usr/local/lib/python3.8/dist-packages (from roboflow) (2.10)\n","Collecting wget\n","  Downloading wget-3.2.zip (10 kB)\n","  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Collecting cycler==0.10.0\n","  Downloading cycler-0.10.0-py2.py3-none-any.whl (6.5 kB)\n","Requirement already satisfied: six in /usr/local/lib/python3.8/dist-packages (from roboflow) (1.15.0)\n","Requirement already satisfied: Pillow>=7.1.2 in /usr/local/lib/python3.8/dist-packages (from roboflow) (7.1.2)\n","Requirement already satisfied: python-dateutil in /usr/local/lib/python3.8/dist-packages (from roboflow) (2.8.2)\n","Requirement already satisfied: kiwisolver>=1.3.1 in /usr/local/lib/python3.8/dist-packages (from roboflow) (1.4.4)\n","Requirement already satisfied: certifi==2022.12.7 in /usr/local/lib/python3.8/dist-packages (from roboflow) (2022.12.7)\n","Collecting pyparsing==2.4.7\n","  Downloading pyparsing-2.4.7-py2.py3-none-any.whl (67 kB)\n","\u001b[2K     \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m67.8/67.8 KB\u001b[0m \u001b[31m9.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: matplotlib in /usr/local/lib/python3.8/dist-packages (from roboflow) (3.2.2)\n","Collecting python-dotenv\n","  Downloading python_dotenv-0.21.0-py3-none-any.whl (18 kB)\n","Requirement already satisfied: PyYAML>=5.3.1 in /usr/local/lib/python3.8/dist-packages (from roboflow) (6.0)\n","Collecting urllib3==1.26.6\n","  Downloading urllib3-1.26.6-py2.py3-none-any.whl (138 kB)\n","\u001b[2K     \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m138.5/138.5 KB\u001b[0m \u001b[31m17.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting requests-toolbelt\n","  Downloading requests_toolbelt-0.10.1-py2.py3-none-any.whl (54 kB)\n","\u001b[2K     \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m54.5/54.5 KB\u001b[0m \u001b[31m7.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: glob2 in /usr/local/lib/python3.8/dist-packages (from roboflow) (0.7)\n","Requirement already satisfied: tqdm>=4.41.0 in /usr/local/lib/python3.8/dist-packages (from roboflow) (4.64.1)\n","Requirement already satisfied: requests in /usr/local/lib/python3.8/dist-packages (from roboflow) (2.25.1)\n","Building wheels for collected packages: wget\n","  Building wheel for wget (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for wget: filename=wget-3.2-py3-none-any.whl size=9674 sha256=fdc3732429fe746d79b653bd23b44c66b28dbdbd6d6731985d50509827e63203\n","  Stored in directory: /root/.cache/pip/wheels/bd/a8/c3/3cf2c14a1837a4e04bd98631724e81f33f462d86a1d895fae0\n","Successfully built wget\n","Installing collected packages: wget, urllib3, python-dotenv, pyparsing, cycler, requests-toolbelt, roboflow\n","  Attempting uninstall: urllib3\n","    Found existing installation: urllib3 1.24.3\n","    Uninstalling urllib3-1.24.3:\n","      Successfully uninstalled urllib3-1.24.3\n","  Attempting uninstall: pyparsing\n","    Found existing installation: pyparsing 3.0.9\n","    Uninstalling pyparsing-3.0.9:\n","      Successfully uninstalled pyparsing-3.0.9\n","  Attempting uninstall: cycler\n","    Found existing installation: cycler 0.11.0\n","    Uninstalling cycler-0.11.0:\n","      Successfully uninstalled cycler-0.11.0\n","Successfully installed cycler-0.10.0 pyparsing-2.4.7 python-dotenv-0.21.0 requests-toolbelt-0.10.1 roboflow-0.2.24 urllib3-1.26.6 wget-3.2\n"]},{"output_type":"display_data","data":{"application/vnd.colab-display-data+json":{"pip_warning":{"packages":["cycler","pyparsing"]}}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["loading Roboflow workspace...\n","loading Roboflow project...\n","Downloading Dataset Version Zip in hot-air-balloon-1 to yolov5pytorch: 100% [7411432 / 7411432] bytes\n"]},{"output_type":"stream","name":"stderr","text":["Extracting Dataset Version Zip to hot-air-balloon-1 in yolov5pytorch:: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 670/670 [02:51<00:00,  3.91it/s]\n"]}],"source":["!pip install roboflow\n","\n","from roboflow import Roboflow\n","rf = Roboflow(api_key=\"tWOFp15aIQOU6nZCoRs4\")\n","project = rf.workspace(\"tututu\").project(\"hot-air-balloon\")\n","dataset = project.version(1).download(\"yolov5\")"],"id":"t7lzUqchIYVW"},{"cell_type":"code","execution_count":null,"metadata":{"id":"DqY6_2V6xGHu"},"outputs":[],"source":["from IPython.display import Image"],"id":"DqY6_2V6xGHu"},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":14537,"status":"ok","timestamp":1673403177621,"user":{"displayName":"tututu","userId":"15506491728105383454"},"user_tz":-540},"id":"22fb3346","outputId":"e157b4b8-5ca3-4184-ab7c-126f3ee939ba"},"outputs":[{"output_type":"stream","name":"stderr","text":["YOLOv5 ðŸš€ v7.0-61-gcaba2ae Python-3.8.16 torch-1.13.0+cu116 CUDA:0 (Tesla T4, 15110MiB)\n"]},{"output_type":"stream","name":"stdout","text":["Setup complete âœ… (2 CPUs, 12.7 GB RAM, 23.1/78.2 GB disk)\n"]}],"source":["!git clone https://github.com/ultralytics/yolov5  # clone\n","%cd yolov5\n","%pip install -qr requirements.txt  # install\n","\n","import torch\n","import utils\n","display = utils.notebook_init()  # checks"],"id":"22fb3346"},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":277,"status":"ok","timestamp":1673403204423,"user":{"displayName":"tututu","userId":"15506491728105383454"},"user_tz":-540},"id":"7e4e34b6","outputId":"1579b790-aa47-43ab-84c3-001f47d37057"},"outputs":[{"output_type":"stream","name":"stdout","text":["benchmarks.py\t detect.py   __pycache__       segment\t       val.py\n","CITATION.cff\t export.py   README.md\t       setup.cfg       yolov5s.pt\n","classify\t hubconf.py  README.zh-CN.md   train.py\n","CONTRIBUTING.md  LICENSE     requirements.txt  tutorial.ipynb\n","data\t\t models      runs\t       utils\n"]}],"source":["!ls"],"id":"7e4e34b6"},{"cell_type":"markdown","metadata":{"id":"b1849821"},"source":[],"id":"b1849821"},{"cell_type":"code","execution_count":null,"metadata":{"id":"326ebc77"},"outputs":[],"source":["import os\n","import shutil\n","import numpy as np\n","import tqdm"],"id":"326ebc77"},{"cell_type":"markdown","metadata":{"id":"aa5bd9a2"},"source":["**Read the annotations file**"],"id":"aa5bd9a2"},{"cell_type":"markdown","metadata":{"id":"xmiLYgDAoJrj"},"source":["# í›ˆë ¨"],"id":"xmiLYgDAoJrj"},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":36},"executionInfo":{"elapsed":300,"status":"ok","timestamp":1673403266370,"user":{"displayName":"tututu","userId":"15506491728105383454"},"user_tz":-540},"id":"Ss1_frE8JgE8","outputId":"8fa95f9d-7484-4f7f-fe08-4c3f1e576770"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["'/content/drive/MyDrive/hot-air-balloon-1/yolov5'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":12}],"source":["%pwd"],"id":"Ss1_frE8JgE8"},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"d41433e6","outputId":"05314dcb-6b71-4638-d32d-3b32aaba4e39"},"outputs":[{"output_type":"stream","name":"stdout","text":["\u001b[34m\u001b[1mtrain: \u001b[0mweights=yolov5s.pt, cfg=, data=/content/drive/MyDrive/hot-air-balloon-1/data.yaml, hyp=data/hyps/hyp.scratch-low.yaml, epochs=60, batch_size=16, imgsz=640, rect=False, resume=False, nosave=False, noval=False, noautoanchor=False, noplots=False, evolve=None, bucket=, cache=None, image_weights=False, device=, multi_scale=False, single_cls=False, optimizer=SGD, sync_bn=False, workers=8, project=runs/train, name=exp, exist_ok=False, quad=False, cos_lr=False, label_smoothing=0.0, patience=100, freeze=[0], save_period=-1, seed=0, local_rank=-1, entity=None, upload_dataset=False, bbox_interval=-1, artifact_alias=latest\n","\u001b[34m\u001b[1mgithub: \u001b[0mâš ï¸ YOLOv5 is out of date by 2 commits. Use `git pull` or `git clone https://github.com/ultralytics/yolov5` to update.\n","YOLOv5 ðŸš€ v7.0-61-gcaba2ae Python-3.8.16 torch-1.13.0+cu116 CUDA:0 (Tesla T4, 15110MiB)\n","\n","\u001b[34m\u001b[1mhyperparameters: \u001b[0mlr0=0.01, lrf=0.01, momentum=0.937, weight_decay=0.0005, warmup_epochs=3.0, warmup_momentum=0.8, warmup_bias_lr=0.1, box=0.05, cls=0.5, cls_pw=1.0, obj=1.0, obj_pw=1.0, iou_t=0.2, anchor_t=4.0, fl_gamma=0.0, hsv_h=0.015, hsv_s=0.7, hsv_v=0.4, degrees=0.0, translate=0.1, scale=0.5, shear=0.0, perspective=0.0, flipud=0.0, fliplr=0.5, mosaic=1.0, mixup=0.0, copy_paste=0.0\n","\u001b[34m\u001b[1mClearML: \u001b[0mrun 'pip install clearml' to automatically track, visualize and remotely train YOLOv5 ðŸš€ in ClearML\n","\u001b[34m\u001b[1mComet: \u001b[0mrun 'pip install comet_ml' to automatically track and visualize YOLOv5 ðŸš€ runs in Comet\n","\u001b[34m\u001b[1mTensorBoard: \u001b[0mStart with 'tensorboard --logdir runs/train', view at http://localhost:6006/\n","Overriding model.yaml nc=80 with nc=1\n","\n","                 from  n    params  module                                  arguments                     \n","  0                -1  1      3520  models.common.Conv                      [3, 32, 6, 2, 2]              \n","  1                -1  1     18560  models.common.Conv                      [32, 64, 3, 2]                \n","  2                -1  1     18816  models.common.C3                        [64, 64, 1]                   \n","  3                -1  1     73984  models.common.Conv                      [64, 128, 3, 2]               \n","  4                -1  2    115712  models.common.C3                        [128, 128, 2]                 \n","  5                -1  1    295424  models.common.Conv                      [128, 256, 3, 2]              \n","  6                -1  3    625152  models.common.C3                        [256, 256, 3]                 \n","  7                -1  1   1180672  models.common.Conv                      [256, 512, 3, 2]              \n","  8                -1  1   1182720  models.common.C3                        [512, 512, 1]                 \n","  9                -1  1    656896  models.common.SPPF                      [512, 512, 5]                 \n"," 10                -1  1    131584  models.common.Conv                      [512, 256, 1, 1]              \n"," 11                -1  1         0  torch.nn.modules.upsampling.Upsample    [None, 2, 'nearest']          \n"," 12           [-1, 6]  1         0  models.common.Concat                    [1]                           \n"," 13                -1  1    361984  models.common.C3                        [512, 256, 1, False]          \n"," 14                -1  1     33024  models.common.Conv                      [256, 128, 1, 1]              \n"," 15                -1  1         0  torch.nn.modules.upsampling.Upsample    [None, 2, 'nearest']          \n"," 16           [-1, 4]  1         0  models.common.Concat                    [1]                           \n"," 17                -1  1     90880  models.common.C3                        [256, 128, 1, False]          \n"," 18                -1  1    147712  models.common.Conv                      [128, 128, 3, 2]              \n"," 19          [-1, 14]  1         0  models.common.Concat                    [1]                           \n"," 20                -1  1    296448  models.common.C3                        [256, 256, 1, False]          \n"," 21                -1  1    590336  models.common.Conv                      [256, 256, 3, 2]              \n"," 22          [-1, 10]  1         0  models.common.Concat                    [1]                           \n"," 23                -1  1   1182720  models.common.C3                        [512, 512, 1, False]          \n"," 24      [17, 20, 23]  1     16182  models.yolo.Detect                      [1, [[10, 13, 16, 30, 33, 23], [30, 61, 62, 45, 59, 119], [116, 90, 156, 198, 373, 326]], [128, 256, 512]]\n","Model summary: 214 layers, 7022326 parameters, 7022326 gradients, 15.9 GFLOPs\n","\n","Transferred 343/349 items from yolov5s.pt\n","\u001b[34m\u001b[1mAMP: \u001b[0mchecks passed âœ…\n","\u001b[34m\u001b[1moptimizer:\u001b[0m SGD(lr=0.01) with parameter groups 57 weight(decay=0.0), 60 weight(decay=0.0005), 60 bias\n","\u001b[34m\u001b[1malbumentations: \u001b[0mBlur(p=0.01, blur_limit=(3, 7)), MedianBlur(p=0.01, blur_limit=(3, 7)), ToGray(p=0.01), CLAHE(p=0.01, clip_limit=(1, 4.0), tile_grid_size=(8, 8))\n","\u001b[34m\u001b[1mtrain: \u001b[0mScanning /content/drive/MyDrive/hot-air-balloon-1/train/labels.cache... 281 images, 0 backgrounds, 0 corrupt: 100% 281/281 [00:00<?, ?it/s]\n","\u001b[34m\u001b[1mval: \u001b[0mScanning /content/drive/MyDrive/hot-air-balloon-1/valid/labels.cache... 31 images, 0 backgrounds, 0 corrupt: 100% 31/31 [00:00<?, ?it/s]\n","\n","\u001b[34m\u001b[1mAutoAnchor: \u001b[0m1.97 anchors/target, 1.000 Best Possible Recall (BPR). Current anchors are a good fit to dataset âœ…\n","Plotting labels to runs/train/exp4/labels.jpg... \n","Image sizes 640 train, 640 val\n","Using 2 dataloader workers\n","Logging results to \u001b[1mruns/train/exp4\u001b[0m\n","Starting training for 60 epochs...\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","       0/59      3.72G     0.1246    0.03284          0         29        640: 100% 18/18 [00:10<00:00,  1.67it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:02<00:00,  2.87s/it]\n","                   all         31         31    0.00183      0.548    0.00457   0.000905\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","       1/59      4.59G    0.09104    0.03016          0         26        640: 100% 18/18 [00:07<00:00,  2.40it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  1.06it/s]\n","                   all         31         31      0.103      0.129     0.0739     0.0193\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","       2/59      4.59G    0.07338    0.02791          0         29        640: 100% 18/18 [00:07<00:00,  2.42it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  1.39it/s]\n","                   all         31         31      0.298       0.29      0.289      0.087\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","       3/59      4.59G    0.06622     0.0245          0         22        640: 100% 18/18 [00:07<00:00,  2.46it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  1.33it/s]\n","                   all         31         31      0.373      0.387      0.326     0.0999\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","       4/59      4.59G    0.06046    0.02062          0         26        640: 100% 18/18 [00:07<00:00,  2.40it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  2.37it/s]\n","                   all         31         31      0.428       0.71      0.528      0.145\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","       5/59      4.59G    0.06173    0.01959          0         28        640: 100% 18/18 [00:07<00:00,  2.33it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  2.28it/s]\n","                   all         31         31      0.539       0.71      0.665      0.203\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","       6/59      4.59G    0.05265    0.01755          0         23        640: 100% 18/18 [00:07<00:00,  2.42it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  1.71it/s]\n","                   all         31         31      0.664        0.7      0.767       0.28\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","       7/59      4.59G    0.04872    0.01672          0         26        640: 100% 18/18 [00:07<00:00,  2.46it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  1.50it/s]\n","                   all         31         31      0.734       0.89      0.845      0.305\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","       8/59      4.59G    0.04943    0.01501          0         21        640: 100% 18/18 [00:07<00:00,  2.57it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  2.59it/s]\n","                   all         31         31      0.637      0.742      0.663      0.217\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","       9/59      4.59G    0.04082    0.01514          0         33        640: 100% 18/18 [00:08<00:00,  2.22it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  1.88it/s]\n","                   all         31         31      0.563      0.806      0.766      0.404\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      10/59      4.59G    0.04478    0.01362          0         21        640: 100% 18/18 [00:07<00:00,  2.48it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  1.92it/s]\n","                   all         31         31      0.908      0.871       0.96       0.64\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      11/59      4.59G    0.03898    0.01327          0         19        640: 100% 18/18 [00:07<00:00,  2.40it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  2.11it/s]\n","                   all         31         31          1      0.999      0.995      0.728\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      12/59      4.59G    0.04034    0.01301          0         20        640: 100% 18/18 [00:07<00:00,  2.47it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  1.34it/s]\n","                   all         31         31          1      0.996      0.995      0.836\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      13/59      4.59G    0.03766    0.01279          0         27        640: 100% 18/18 [00:07<00:00,  2.53it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  2.37it/s]\n","                   all         31         31      0.988      0.935      0.983      0.676\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      14/59      4.59G    0.03717    0.01112          0         25        640: 100% 18/18 [00:07<00:00,  2.35it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  1.98it/s]\n","                   all         31         31          1      0.981      0.995      0.786\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      15/59      4.59G     0.0361    0.01111          0         23        640: 100% 18/18 [00:10<00:00,  1.66it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  1.85it/s]\n","                   all         31         31      0.995      0.968      0.994      0.792\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      16/59      4.59G     0.0329     0.0115          0         31        640: 100% 18/18 [00:07<00:00,  2.44it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  1.75it/s]\n","                   all         31         31      0.966          1      0.993      0.864\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      17/59      4.59G    0.03251    0.01028          0         23        640: 100% 18/18 [00:07<00:00,  2.52it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  1.90it/s]\n","                   all         31         31      0.997          1      0.995      0.791\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      18/59      4.59G    0.03342    0.01038          0         27        640: 100% 18/18 [00:07<00:00,  2.33it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  1.98it/s]\n","                   all         31         31      0.997          1      0.995      0.812\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      19/59      4.59G    0.03025   0.009819          0         22        640: 100% 18/18 [00:07<00:00,  2.34it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  1.89it/s]\n","                   all         31         31          1       0.99      0.995      0.751\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      20/59      4.59G    0.03159    0.01058          0         33        640: 100% 18/18 [00:07<00:00,  2.43it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  2.35it/s]\n","                   all         31         31          1      0.996      0.995      0.767\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      21/59      4.59G    0.02889   0.009848          0         19        640: 100% 18/18 [00:07<00:00,  2.32it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  1.98it/s]\n","                   all         31         31      0.993      0.968      0.994      0.847\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      22/59      4.59G    0.02956    0.01004          0         27        640: 100% 18/18 [00:07<00:00,  2.45it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  1.81it/s]\n","                   all         31         31          1      0.997      0.995       0.86\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      23/59      4.59G    0.02722    0.00992          0         24        640: 100% 18/18 [00:07<00:00,  2.32it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  2.10it/s]\n","                   all         31         31      0.998          1      0.995      0.883\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      24/59      4.59G    0.02848   0.009401          0         23        640: 100% 18/18 [00:07<00:00,  2.31it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  2.04it/s]\n","                   all         31         31      0.996          1      0.995      0.845\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      25/59      4.59G    0.02825   0.009154          0         25        640: 100% 18/18 [00:07<00:00,  2.40it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  1.64it/s]\n","                   all         31         31      0.993          1      0.995      0.809\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      26/59      4.59G    0.02798     0.0092          0         26        640: 100% 18/18 [00:07<00:00,  2.46it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  1.81it/s]\n","                   all         31         31      0.997          1      0.995      0.813\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      27/59      4.59G    0.02795   0.008336          0         24        640: 100% 18/18 [00:07<00:00,  2.36it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  1.99it/s]\n","                   all         31         31      0.997          1      0.995      0.826\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      28/59      4.59G    0.02837   0.009312          0         28        640: 100% 18/18 [00:07<00:00,  2.36it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  1.96it/s]\n","                   all         31         31      0.979          1      0.995      0.726\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      29/59      4.59G    0.02697   0.009017          0         28        640: 100% 18/18 [00:07<00:00,  2.43it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  1.59it/s]\n","                   all         31         31      0.999          1      0.995      0.831\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      30/59      4.59G    0.02373   0.008787          0         23        640: 100% 18/18 [00:07<00:00,  2.32it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  1.78it/s]\n","                   all         31         31      0.998          1      0.995      0.846\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      31/59      4.59G    0.02479   0.008605          0         20        640: 100% 18/18 [00:07<00:00,  2.43it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  1.85it/s]\n","                   all         31         31      0.998          1      0.995      0.888\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      32/59      4.59G    0.02389   0.009009          0         27        640: 100% 18/18 [00:07<00:00,  2.36it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  1.97it/s]\n","                   all         31         31      0.998          1      0.995      0.933\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      33/59      4.59G    0.02324   0.008877          0         31        640: 100% 18/18 [00:07<00:00,  2.36it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  1.57it/s]\n","                   all         31         31      0.969      0.997      0.994      0.915\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      34/59      4.59G    0.02329   0.008815          0         30        640: 100% 18/18 [00:07<00:00,  2.37it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  2.33it/s]\n","                   all         31         31          1      0.998      0.995      0.874\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      35/59      4.59G    0.02441   0.008794          0         20        640: 100% 18/18 [00:07<00:00,  2.41it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  1.48it/s]\n","                   all         31         31          1      0.967       0.99       0.87\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      36/59      4.59G    0.02521   0.008905          0         30        640: 100% 18/18 [00:07<00:00,  2.40it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  1.99it/s]\n","                   all         31         31      0.997      0.968      0.994       0.89\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      37/59      4.59G    0.02463   0.008532          0         25        640: 100% 18/18 [00:07<00:00,  2.37it/s]\n","                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100% 1/1 [00:00<00:00,  1.99it/s]\n","                   all         31         31          1      0.996      0.995      0.898\n","\n","      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n","      38/59      4.59G    0.02188   0.008607          0         49        640:  78% 14/18 [00:05<00:01,  2.37it/s]"]}],"source":["!python train.py --img 640 --batch 16 --epochs 60  --data /content/drive/MyDrive/hot-air-balloon-1/data.yaml --weights yolov5s.pt"],"id":"d41433e6"},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":36},"executionInfo":{"elapsed":8,"status":"ok","timestamp":1673402782713,"user":{"displayName":"tututu","userId":"15506491728105383454"},"user_tz":-540},"id":"aQwo5xTNKnzj","outputId":"e4d20cfd-0701-4482-d9e3-ff30dfb54908"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["'/content'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":1}],"source":["%pwd"],"id":"aQwo5xTNKnzj"},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":298,"status":"ok","timestamp":1673402911976,"user":{"displayName":"tututu","userId":"15506491728105383454"},"user_tz":-540},"id":"6ceee3d5","outputId":"e3760de8-8ca7-4109-f849-423e562a160d"},"outputs":[{"output_type":"stream","name":"stdout","text":["python3: can't open file 'detect.py': [Errno 2] No such file or directory\n"]}],"source":["# !cp runs/exp/weights/best.pt weights\n","!python detect.py --weights runs/train/exp/weights/best.pt --img 640 --conf 0.3 --source /content/eiffel2-8/test/images/p_0922_17152_589746_jpg.rf.1f3043f628658aa44e3189a25250b47a.jpg \\\n","--name ì—íŽ íƒ‘ --save-txt --save-conf"],"id":"6ceee3d5"},{"cell_type":"markdown","metadata":{"id":"XSfIGOtfa7w0"},"source":["## "],"id":"XSfIGOtfa7w0"},{"cell_type":"code","execution_count":null,"metadata":{"id":"A9W97-1AiXNY"},"outputs":[],"source":[],"id":"A9W97-1AiXNY"}],"metadata":{"accelerator":"GPU","colab":{"machine_shape":"hm","provenance":[{"file_id":"1ZSm1rbmLJhT0PYzXs0FNfy3APti1-m5Z","timestamp":1672992448535}]},"gpuClass":"premium","kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.7.12"},"papermill":{"default_parameters":{},"duration":27844.971112,"end_time":"2022-03-27T12:49:47.857970","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2022-03-27T05:05:42.886858","version":"2.3.3"}},"nbformat":4,"nbformat_minor":5}